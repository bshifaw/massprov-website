{{ define "main" }}
  <section class="section">
    <p class="pill" style="margin:0;">Contact</p>
    <h1>Reach out or join the WhatsApp community.</h1>
    <p class="muted">Ask a question, share ideas, or request an invite to the MassProv WhatsApp group.</p>

    <div class="grid" style="gap:20px; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); margin-top:20px;">
      <div class="card">
        <form id="contact-form" action="https://docs.google.com/forms/u/0/d/e/1FAIpQLScs6MR174VH7H2PvKi8HgEngw4LfTYf6wG3SWT8fUWQboqJag/formResponse" method="POST" target="_self">
          <input type="hidden" name="fvv" value="1">
          <input type="hidden" name="partialResponse" value="[null,null,&quot;-3194330751155562024&quot;]">
          <input type="hidden" name="pageHistory" value="0">
          <input type="hidden" name="fbzx" value="-3194330751155562024">
          <input type="hidden" name="submissionTimestamp" value="-1">
          <div class="field">
            <label for="email">Email *</label>
            <input id="email" name="emailAddress" type="email" required autocomplete="email" />
          </div>
          <div class="field">
            <label for="name">Name</label>
            <input id="name" name="entry.1375493514" type="text" autocomplete="name" />
          </div>
          <div class="field">
            <label for="message">Message (ask to join WhatsApp, or any question)</label>
            <textarea id="message" name="entry.1288429191" required></textarea>
          </div>
          <div class="field hp-field" aria-hidden="true">
            <label for="contact-check">Leave this blank</label>
            <input id="contact-check" type="text" name="hp_field" tabindex="-1" autocomplete="off" value="">
          </div>
          <input type="hidden" name="form_started_at" value="">
          <button class="btn btn-primary" type="submit">Send</button>
          <p id="contact-form-status" class="muted" style="margin:6px 0 0;"></p>
          <p class="muted" style="margin-top:10px;">Submits securely to Google Forms. Please avoid sharing sensitive info.</p>
        </form>
      </div>
      <div class="card">
        <h3>What to expect</h3>
        <ul style="padding-left:18px; margin:0 0 12px;">
          <li>Invite to the WhatsApp group (if requested)</li>
          <li>Answers to questions about shows, jams, or resources</li>
          <li>Volunteer opportunities and how to feature your events</li>
        </ul>
        <p class="muted">We aim to reply within a few days. For event submissions, use the submission form so we can add it quickly.</p>
        <a class="btn btn-secondary" href="{{ "submit-event/" | relURL }}">Submit an event</a>
      </div>
    </div>
  </section>
  <script>
    (function () {
      const form = document.getElementById('contact-form');
      if (!form) return;

      const statusEl = document.getElementById('contact-form-status');
      const startedAt = Date.now();
      const minDelayMs = 3000;

      const startedField = form.querySelector('input[name="form_started_at"]');
      if (startedField) startedField.value = startedAt;

      form.addEventListener('submit', function (event) {
        const honeypot = form.querySelector('input[name="hp_field"]');
        const elapsed = Date.now() - startedAt;

        if (honeypot && honeypot.value.trim()) {
          event.preventDefault();
          if (statusEl) statusEl.textContent = 'Please leave the blank field empty.';
          return;
        }

        if (elapsed < minDelayMs) {
          event.preventDefault();
          if (statusEl) statusEl.textContent = 'Please wait a few seconds before submitting.';
          return;
        }

        if (statusEl) statusEl.textContent = '';
      });
    })();
  </script>
  <style>
    .hp-field {
      position: absolute;
      left: -10000px;
      height: 0;
      overflow: hidden;
    }
  </style>
{{ end }}
